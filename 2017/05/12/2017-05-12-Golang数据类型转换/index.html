<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Golang 数据类型转换 · MEX7</title><meta name="description" content="Golang 数据类型转换 - mex7"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="http://mex7.github.io/atom.xml" title="MEX7"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="MEX7" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">MEX7</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>INDEX</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>ARCHIVES</p></a><ul class="shortcut-icons"><a href="https://github.com/AngryPowman" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">Golang 数据类型转换</h1><div class="post-info">May 12, 2017</div><div class="post-content"><h2 id="string-amp-int"><a href="#string-amp-int" class="headerlink" title="string &amp; int"></a>string &amp; int</h2><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; string2int</span><br><span class="line">func string2int(s string)(r int)&#123;</span><br><span class="line">    r,err :&#x3D; strconv.Atoi(s)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        fmt.Println(&quot;error:&quot;, err)</span><br><span class="line">    &#125;</span><br><span class="line">    return r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; int2string</span><br><span class="line">func int2string(i int)(r string)&#123;</span><br><span class="line">    r &#x3D; strconv.Itoa(i)</span><br><span class="line">    return r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p><code>strconv.Atoi(s)</code>将字符串转换为十进制整数</p>
<p>等价于<code>strconv.ParseInt(s, 10, 0)</code></p>
<p>err返回类型：</p>
<ul>
<li>NumErr </li>
<li>ErrSyntax 语法有误</li>
<li>ErrRange 超出类型范围</li>
</ul>
<p><code>strconv.Itoa(i)</code>也是一个再次封装的函数，和<code>Atoi</code>类似，等价的存在<code>FormatInt(i, 10)</code></p>
<h3 id="潜在问题"><a href="#潜在问题" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>使用<code>func ParseInt(s string, base int, bitSize int) (i int64, err error)</code>时，必须注意bitSize的问题，防止赋值溢出的问题</p>
<hr>
<h2 id="string-amp-int64"><a href="#string-amp-int64" class="headerlink" title="string &amp; int64"></a>string &amp; int64</h2><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; string2int64</span><br><span class="line">func string2int64(s string)(r int64)&#123;</span><br><span class="line">    r,err :&#x3D; strconv.ParseInt(s, 10, 64)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        fmt.Println(&quot;error:&quot;, err)</span><br><span class="line">    &#125;</span><br><span class="line">    return r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; int642string</span><br><span class="line">func int642string(i int64)(r string)&#123;</span><br><span class="line">    r &#x3D; strconv.FormatInt(i, 10)</span><br><span class="line">    return r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h3><p><code>func ParseInt(s string, base int, bitSize int) (i int64, err error)</code></p>
<p><code>func FormatInt(i int64, base int) string</code><br><code>base</code> 介于2-36之间</p>
<h3 id="潜在问题-1"><a href="#潜在问题-1" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>注意入参的问题，如果传入类似<code>hello</code>的字符串会产生格式错误，另外就是防止溢出</p>
<hr>
<h2 id="string-amp-float"><a href="#string-amp-float" class="headerlink" title="string &amp; float"></a>string &amp; float</h2><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; string2float</span><br><span class="line">func string2float(s string)(r float64)&#123;</span><br><span class="line">    r,err :&#x3D; strconv.ParseFloat(s, 64)</span><br><span class="line">    if err !&#x3D; nil &#123;</span><br><span class="line">        fmt.Println(&quot;error:&quot;, err)</span><br><span class="line">    &#125;</span><br><span class="line">    return r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; string2float</span><br><span class="line">func float642string(i float64)(r string)&#123;</span><br><span class="line">    r &#x3D; strconv.FormatFloat(i, &#39;f&#39;, 10, 64)</span><br><span class="line">    return r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="说明-2"><a href="#说明-2" class="headerlink" title="说明"></a>说明</h3><p><code>func ParseFloat(s string, bitSize int) (f float64, err error)</code></p>
<ul>
<li><code>bitSize</code> 期望接受类型</li>
</ul>
<p><code>func FormatFloat(f float64, fmt byte, prec, bitSize int) string</code></p>
<ul>
<li><code>prec</code> 精度</li>
<li><code>bitSize</code> 入参类型</li>
<li><code>fmt</code> 返回数据的格式<ul>
<li>‘f’（-ddd.dddd）</li>
<li>‘b’（-ddddp±ddd，指数为二进制）</li>
<li>‘e’（-d.dddde±dd，十进制指数）</li>
<li>‘E’（-d.ddddE±dd，十进制指数）</li>
<li>‘g’（指数很大时用’e’格式，否则’f’格式）</li>
<li>‘G’（指数很大时用’E’格式，否则’f’格式）</li>
</ul>
</li>
</ul>
<h3 id="潜在问题-2"><a href="#潜在问题-2" class="headerlink" title="潜在问题"></a>潜在问题</h3><hr>
<h2 id="byte-amp-int"><a href="#byte-amp-int" class="headerlink" title="[]byte &amp; int"></a>[]byte &amp; int</h2><h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; []byte to int</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; int to []byte</span><br><span class="line">[]byte()</span><br></pre></td></tr></table></figure>
<h3 id="说明-3"><a href="#说明-3" class="headerlink" title="说明"></a>说明</h3><h3 id="潜在问题-3"><a href="#潜在问题-3" class="headerlink" title="潜在问题"></a>潜在问题</h3><hr>
<h2 id="byte-amp-int32"><a href="#byte-amp-int32" class="headerlink" title="[]byte &amp; int32"></a>[]byte &amp; int32</h2><h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; int32 to bytes</span><br><span class="line">var x int32</span><br><span class="line">x &#x3D; 106</span><br><span class="line">bytesBuffer :&#x3D; bytes.NewBuffer([]byte&#123;&#125;)</span><br><span class="line">binary.Write(bytesBuffer, binary.BigEndian, x)</span><br><span class="line">fmt.Println(bytesBuffer.Bytes())</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; bytes to int32</span><br><span class="line">func byte2int32(b []byte)(r int32)&#123;</span><br><span class="line">    bytesBuffer :&#x3D; bytes.NewBuffer(b)</span><br><span class="line">    binary.Read(bytesBuffer, binary.BigEndian, &amp;r)</span><br><span class="line">    return</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="说明-4"><a href="#说明-4" class="headerlink" title="说明"></a>说明</h3><h3 id="潜在问题-4"><a href="#潜在问题-4" class="headerlink" title="潜在问题"></a>潜在问题</h3><hr>
<h2 id="byte-amp-uint"><a href="#byte-amp-uint" class="headerlink" title="[]byte &amp; uint"></a>[]byte &amp; uint</h2><h3 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 实现ByteOrder接口</span><br><span class="line">type ByteOrder interface &#123;</span><br><span class="line">    Uint16([]byte) uint16</span><br><span class="line">    Uint32([]byte) uint32</span><br><span class="line">    Uint64([]byte) uint64</span><br><span class="line">    PutUint16([]byte, uint16)</span><br><span class="line">    PutUint32([]byte, uint32)</span><br><span class="line">    PutUint64([]byte, uint64)</span><br><span class="line">    String() string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; byte to uint8</span><br><span class="line">uint8(b)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; uint8 to byte</span><br><span class="line">byte(i)</span><br></pre></td></tr></table></figure>
<h3 id="说明-5"><a href="#说明-5" class="headerlink" title="说明"></a>说明</h3><p>使用<code>encoding/binary</code>包下 <code>BigEndian</code>高位编址 <code>LittleEndian</code>低位编址 进行8位以上无符号整形于byte数组之间进行转换</p>
<h3 id="潜在问题-5"><a href="#潜在问题-5" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>[]byte与uint转换必须考虑长度与类型的匹配度，转换的核心是<code>位移</code></p>
<hr>
<h2 id="byte-amp-string"><a href="#byte-amp-string" class="headerlink" title="[]byte &amp; string"></a>[]byte &amp; string</h2><h3 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ByteToHex</span><br><span class="line">func ByteToHex(data []byte) string &#123;</span><br><span class="line">    buffer :&#x3D; new(bytes.Buffer)</span><br><span class="line">    for _, b :&#x3D; range data &#123;</span><br><span class="line">        s :&#x3D; strconv.FormatInt(int64(b&amp;0xff), 16)</span><br><span class="line">        if len(s) &#x3D;&#x3D; 1 &#123;</span><br><span class="line">            buffer.WriteString(&quot;0&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        buffer.WriteString(s)</span><br><span class="line">    &#125;</span><br><span class="line">    return buffer.String()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; HexToByte</span><br><span class="line">func HexToByte(hex string) []byte &#123;</span><br><span class="line">    length :&#x3D; len(hex)&#x2F;2</span><br><span class="line">    slice :&#x3D; make([]byte, length)</span><br><span class="line">    rs :&#x3D; []rune(hex)</span><br><span class="line">    for i :&#x3D; 0; i &lt; length; i++ &#123;</span><br><span class="line">        s :&#x3D; string(rs[i*2 : i*2+2])</span><br><span class="line">        value, _ :&#x3D; strconv.ParseInt(s, 16, 10)</span><br><span class="line">        slice[i] &#x3D; byte(value &amp; 0xFF)</span><br><span class="line">    &#125;</span><br><span class="line">    return slice</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="说明-6"><a href="#说明-6" class="headerlink" title="说明"></a>说明</h3><p>[]byte转字符串是进行字符串拼接，创建一个buffer，byte转换之后写入buffer流。</p>
<p>字符串转化成rune类型数组，2位进行转化，16进制到10进制，放入切片。</p>
<h3 id="潜在问题-6"><a href="#潜在问题-6" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>[]byte与uint转换必须考虑长度与类型的匹配度，转换的核心是<code>位移</code></p>
<hr>
<h2 id="byte-amp-string-1"><a href="#byte-amp-string-1" class="headerlink" title="byte &amp; string"></a>byte &amp; string</h2><h3 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; string to </span><br><span class="line">[]byte()</span><br></pre></td></tr></table></figure>
<h3 id="说明-7"><a href="#说明-7" class="headerlink" title="说明"></a>说明</h3><p>NIL</p>
<h3 id="潜在问题-7"><a href="#潜在问题-7" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>NIL</p>
<hr>
<h2 id="byte-amp-uint8"><a href="#byte-amp-uint8" class="headerlink" title="byte &amp; uint8"></a>byte &amp; uint8</h2><h3 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h3><p>byte2uint8</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uint8(b)</span><br></pre></td></tr></table></figure>

<p>uint82byte</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">byte(i)</span><br></pre></td></tr></table></figure>
<h3 id="说明-8"><a href="#说明-8" class="headerlink" title="说明"></a>说明</h3><p>在golang中byte和uint8都是八位，所以可以直接进行转换</p>
<h3 id="潜在问题-8"><a href="#潜在问题-8" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>…</p>
<hr>
<h2 id="uint-amp-int-float"><a href="#uint-amp-int-float" class="headerlink" title="uint &amp; int float"></a>uint &amp; int float</h2><h3 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; (int||float) 2 uint</span><br><span class="line">uint()</span><br></pre></td></tr></table></figure>
<h3 id="说明-9"><a href="#说明-9" class="headerlink" title="说明"></a>说明</h3><p>直接使用uint()</p>
<h3 id="潜在问题-9"><a href="#潜在问题-9" class="headerlink" title="潜在问题"></a>潜在问题</h3></div></article></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'mex7';
var disqus_identifier = '2017/05/12/2017-05-12-Golang数据类型转换/';
var disqus_title = 'Golang 数据类型转换';
var disqus_url = 'http://mex7.github.io/2017/05/12/2017-05-12-Golang数据类型转换/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//mex7.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a href="/2017/08/01/2017-08-01-Elasticsearch/" class="prev">PREV</a><a href="/2017/03/03/2018-11-21-CSGO/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2021 <a href="http://mex7.github.io">mex7</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"MEX",'auto');ga('send','pageview');</script></body></html>