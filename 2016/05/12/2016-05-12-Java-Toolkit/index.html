<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Java Toolkit · MEX7</title><meta name="description" content="Java Toolkit - mex7"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="http://mex7.github.io/atom.xml" title="MEX7"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="MEX7" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">MEX7</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>INDEX</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>ARCHIVES</p></a><ul class="shortcut-icons"><a href="https://github.com/AngryPowman" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">Java Toolkit</h1><div class="post-info">May 12, 2016</div><div class="post-content"><h1 id="Java-Mysql-Based-Operation"><a href="#Java-Mysql-Based-Operation" class="headerlink" title="Java Mysql Based Operation"></a>Java Mysql Based Operation</h1><h2 id="Java-Insert-RETURN-GENERATED-KEYS"><a href="#Java-Insert-RETURN-GENERATED-KEYS" class="headerlink" title="Java Insert RETURN_GENERATED_KEYS"></a>Java Insert RETURN_GENERATED_KEYS</h2><p>When use the insert statement, you will get the new value from the auto increase field</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">connection &#x3D; getDataSource().getConnection();</span><br><span class="line">String sql &#x3D; &quot;INSERT INTO anjibei_account_user_order(&quot; +</span><br><span class="line">        &quot;order_serial,&quot; +</span><br><span class="line">        &quot;update_time&quot; +</span><br><span class="line">        &quot;) &quot; +</span><br><span class="line">        &quot;VALUES(&quot; +</span><br><span class="line">        &quot;&#39;&quot; + order.getOrderSerial() + &quot;&#39;,&quot; +</span><br><span class="line">        &quot;&#39;&quot; + TimeUtils.time() + &quot;&#39;&quot; +</span><br><span class="line">        &quot;)&quot;;</span><br><span class="line"></span><br><span class="line">PreparedStatement ps &#x3D; connection.prepareStatement(sql, java.sql.Statement.RETURN_GENERATED_KEYS);</span><br><span class="line">ps.executeUpdate();</span><br><span class="line">ResultSet rs &#x3D; ps.getGeneratedKeys();</span><br><span class="line">if(rs.next())&#123;</span><br><span class="line">    System.out.println(rs.getInt(1));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><h2 id="Get-Time"><a href="#Get-Time" class="headerlink" title="Get Time"></a>Get Time</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class TimeUtils &#123;</span><br><span class="line">    static SimpleDateFormat simpleDateFormat &#x3D; new SimpleDateFormat(&quot;yyyyMMddHHmmssSSS&quot;, Locale.CHINA);</span><br><span class="line">    public static String timeString()&#123;</span><br><span class="line">        return simpleDateFormat.format(new Date());</span><br><span class="line">    &#125;</span><br><span class="line">    public static int time()</span><br><span class="line">    &#123;</span><br><span class="line">        long nowTime &#x3D; System.currentTimeMillis();</span><br><span class="line">        int time &#x3D; (int)(nowTime&#x2F;1000);</span><br><span class="line">        return  time;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Send-a-Post-or-Get-Request"><a href="#Send-a-Post-or-Get-Request" class="headerlink" title="Send a Post or Get Request"></a>Send a Post or Get Request</h2><p>GET</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">public class HttpRequest &#123;</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 向指定URL发送GET方法的请求</span><br><span class="line">     *</span><br><span class="line">     * @param url</span><br><span class="line">     *            发送请求的URL</span><br><span class="line">     * @param param</span><br><span class="line">     *            请求参数，请求参数应该是 name1&#x3D;value1&amp;name2&#x3D;value2 的形式。</span><br><span class="line">     * @return URL 所代表远程资源的响应结果</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static String sendGet(String url, String param) &#123;</span><br><span class="line">        String result &#x3D; &quot;&quot;;</span><br><span class="line">        BufferedReader in &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            String urlNameString &#x3D; url + &quot;?&quot; + param;</span><br><span class="line">            URL realUrl &#x3D; new URL(urlNameString);</span><br><span class="line">            &#x2F;&#x2F; 打开和URL之间的连接</span><br><span class="line">            URLConnection connection &#x3D; realUrl.openConnection();</span><br><span class="line">            &#x2F;&#x2F; 设置通用的请求属性</span><br><span class="line">            connection.setRequestProperty(&quot;accept&quot;, &quot;*&#x2F;*&quot;);</span><br><span class="line">            connection.setRequestProperty(&quot;connection&quot;, &quot;Keep-Alive&quot;);</span><br><span class="line">            connection.setRequestProperty(&quot;Charset&quot;, &quot;UTF-8&quot;);</span><br><span class="line">            connection.setRequestProperty(&quot;Content-Type&quot;, &quot;text&#x2F;xml; charset&#x3D;UTF-8&quot;);</span><br><span class="line">            connection.setRequestProperty(&quot;user-agent&quot;,</span><br><span class="line">                    &quot;Mozilla&#x2F;4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1)&quot;);</span><br><span class="line">            &#x2F;&#x2F; 建立实际的连接</span><br><span class="line">            connection.connect();</span><br><span class="line">            &#x2F;&#x2F; 获取所有响应头字段</span><br><span class="line">            Map&lt;String, List&lt;String&gt;&gt; map &#x3D; connection.getHeaderFields();</span><br><span class="line">            &#x2F;&#x2F; 遍历所有的响应头字段</span><br><span class="line">            for (String key : map.keySet()) &#123;</span><br><span class="line">                System.out.println(key + &quot;---&gt;&quot; + map.get(key));</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F; 定义 BufferedReader输入流来读取URL的响应</span><br><span class="line">            in &#x3D; new BufferedReader(new InputStreamReader(</span><br><span class="line">                    connection.getInputStream(), &quot;UTF-8&quot;));</span><br><span class="line">            String line;</span><br><span class="line">            while ((line &#x3D; in.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                result +&#x3D; line;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            System.out.println(&quot;发送GET请求出现异常！&quot; + e);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 使用finally块来关闭输入流</span><br><span class="line">        finally &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                if (in !&#x3D; null) &#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Exception e2) &#123;</span><br><span class="line">                e2.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>POST</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">    &#x2F;**</span><br><span class="line">     * 向指定 URL 发送POST方法的请求</span><br><span class="line">     *</span><br><span class="line">     * @param url</span><br><span class="line">     *            发送请求的 URL</span><br><span class="line">     * @param param</span><br><span class="line">     *            请求参数，请求参数应该是 name1&#x3D;value1&amp;name2&#x3D;value2 的形式。</span><br><span class="line">     * @return 所代表远程资源的响应结果</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static String sendPost(String url, String param) &#123;</span><br><span class="line">        PrintWriter out &#x3D; null;</span><br><span class="line">        BufferedReader in &#x3D; null;</span><br><span class="line">        String result &#x3D; &quot;&quot;;</span><br><span class="line">        try &#123;</span><br><span class="line">            URL realUrl &#x3D; new URL(url);</span><br><span class="line">            &#x2F;&#x2F; 打开和URL之间的连接</span><br><span class="line">            URLConnection conn &#x3D; realUrl.openConnection();</span><br><span class="line">            &#x2F;&#x2F; 设置通用的请求属性</span><br><span class="line">            conn.setRequestProperty(&quot;accept&quot;, &quot;*&#x2F;*&quot;);</span><br><span class="line">            conn.setRequestProperty(&quot;connection&quot;, &quot;Keep-Alive&quot;);</span><br><span class="line">            conn.setRequestProperty(&quot;Charset&quot;, &quot;UTF-8&quot;);</span><br><span class="line">            conn.setRequestProperty(&quot;Content-Type&quot;, &quot;text&#x2F;xml; charset&#x3D;UTF-8&quot;);</span><br><span class="line">            conn.setRequestProperty(&quot;user-agent&quot;,</span><br><span class="line">                    &quot;Mozilla&#x2F;4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1)&quot;);</span><br><span class="line">            &#x2F;&#x2F; 发送POST请求必须设置如下两行</span><br><span class="line">            conn.setDoOutput(true);</span><br><span class="line">            conn.setDoInput(true);</span><br><span class="line">            &#x2F;&#x2F; 获取URLConnection对象对应的输出流</span><br><span class="line">            out &#x3D; new PrintWriter(conn.getOutputStream());</span><br><span class="line">            &#x2F;&#x2F; 发送请求参数</span><br><span class="line">            out.print(param);</span><br><span class="line">            &#x2F;&#x2F; flush输出流的缓冲</span><br><span class="line">            out.flush();</span><br><span class="line">            &#x2F;&#x2F; 定义BufferedReader输入流来读取URL的响应</span><br><span class="line">            in &#x3D; new BufferedReader(</span><br><span class="line">                    new InputStreamReader(conn.getInputStream(), &quot;UTF-8&quot;));</span><br><span class="line">            String line;</span><br><span class="line">            while ((line &#x3D; in.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                result +&#x3D; line;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            System.out.println(&quot;发送 POST 请求出现异常！&quot;+e);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;使用finally块来关闭输出流、输入流</span><br><span class="line">        finally&#123;</span><br><span class="line">            try&#123;</span><br><span class="line">                if(out!&#x3D;null)&#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125;</span><br><span class="line">                if(in!&#x3D;null)&#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            catch(IOException ex)&#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h2><p>When you get data from front-sid, the data flow will appear garbled. Here is a solution.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">in &#x3D; new BufferedReader(new InputStreamReader(conn.getInputStream(), &quot;UTF-8&quot;));</span><br><span class="line">StreamResolve streamResolve &#x3D; new StreamResolve();</span><br><span class="line">parameters &#x3D; new String(streamResolve.InputStreamTOByte(req.getInputStream()), &quot;UTF-8&quot;);</span><br></pre></td></tr></table></figure>

<h2 id="Null-Object"><a href="#Null-Object" class="headerlink" title="Null Object"></a>Null Object</h2><p>Empty state judgment of object often remember, and feel there are so many kinds of that.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * Created by MEX on 2015&#x2F;6&#x2F;26.</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class ObjectUtils &#123;</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 判断对象或对象数组中每一个对象是否为空: 对象为null，字符序列长度为0，集合类、Map为empty</span><br><span class="line">     *</span><br><span class="line">     * @param obj</span><br><span class="line">     * @return</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static boolean isNullOrEmpty(Object obj) &#123;</span><br><span class="line">        if (obj &#x3D;&#x3D; null)</span><br><span class="line">            return true;</span><br><span class="line">        if (obj instanceof CharSequence)</span><br><span class="line">            return ((CharSequence) obj).length() &#x3D;&#x3D; 0;</span><br><span class="line">        if (obj instanceof Collection)</span><br><span class="line">            return ((Collection) obj).isEmpty();</span><br><span class="line">        if (obj instanceof Map)</span><br><span class="line">            return ((Map) obj).isEmpty();</span><br><span class="line">        if (obj instanceof Object[]) &#123;</span><br><span class="line">            Object[] object &#x3D; (Object[]) obj;</span><br><span class="line">            if (object.length &#x3D;&#x3D; 0) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            boolean empty &#x3D; true;</span><br><span class="line">            for (int i &#x3D; 0; i &lt; object.length; i++) &#123;</span><br><span class="line">                if (!isNullOrEmpty(object[i])) &#123;</span><br><span class="line">                    empty &#x3D; false;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return empty;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></article></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'mex7';
var disqus_identifier = '2016/05/12/2016-05-12-Java-Toolkit/';
var disqus_title = 'Java Toolkit';
var disqus_url = 'http://mex7.github.io/2016/05/12/2016-05-12-Java-Toolkit/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//mex7.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a href="/2016/05/13/2016-05-13-ingress/" class="prev">PREV</a><a href="/2016/05/12/2016-09-23-patterns/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2021 <a href="http://mex7.github.io">mex7</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"MEX",'auto');ga('send','pageview');</script></body></html>